{% capture carousel_children %}
  {% for product in section.settings.collection.products %}
    {% capture carousel_item_children %}
      {% content_for 'block', type: 'product-card', id: 'product-card', product: product, closest.product: product %}
    {% endcapture %}
    
    {% content_for 'block', type: 'carousel-item', id: 'product-card-item', children: carousel_item_children %}
  {% endfor %}
{% endcapture %}

{% content_for 'block', type: 'carousel', id: 'product-list', children: carousel_children %}

{% schema %}
  {
    "name": "Product list",
    "class": "product-list-wrapper",
    "blocks": [{ "type": "carousel" }],
    "settings": [
      {
        "type": "collection",
        "id": "collection",
        "label": "Collection",
        "info": "Select collection to display"
      }
    ],
    "presets": [
      {
        "name": "Product List",
        "blocks": [
          {
            "type": "carousel",
            "static": true,
            "id": "product-list"
          }
        ]
      }
    ]
  }
{% endschema %}
